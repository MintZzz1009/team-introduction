<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
      $(document).ready(function () {
        show_comment();
      });
      function save_comment() {
        let name = $("#name").val();
        let comment = $("#comment").val();
        $.ajax({
          type: "POST",
          url: "/test",
          data: { name_give: name, comment_give: comment },
          success: function (response) {
            alert(response["msg"]);
            window.location.reload();
          },
        });
      }
      function show_comment() {
        $.ajax({
          type: "GET",
          url: "/test",
          data: {},
          success: function (response) {
            console.log("댓글목록조회", response["tests"]);
            let rows = response["tests"];
            for (let i = 0; i < rows.length; i++) {
              let name = rows[i]["name"];
              let comment = rows[i]["comment"];
              let num1 = rows[i]["num1"];
              let num2 = rows[i]["num2"];
              let num3 = rows[i]["num3"];
              console.log(typeof num1);
              console.log(num1);
              let temp_html = `<li class="card" id="li-${num1}-${num2}-${num3}">
            <div class="card-body">
              <blockquote class="blockquote mb-0">
                <p>${comment}</p>
                <footer class="from-who">${name}</footer>
              </blockquote>
            </div>
            <div class="comment-buttons">
              <button
                onclick="addInput(${num1}, ${num2}, ${num3})"
                type="button"
                class="btn btn-outline-primary"
              >
                수정
              </button>
              <button
                onclick="remove(${num1}, ${num2}, ${num3})"
                type="button"
                class="btn btn-outline-primary"
              >
                삭제
              </button>
            </div>
          </li>`;
              $("#comment_list").append(temp_html);
            }
          },
        });
      }
      // 수정을 위한 input창 열기
      function addInput(num1, num2, num3) {
        console.log(num1);
        let li = $(`#li-${num1}-${num2}-${num3}`);
        console.log(li);
        let wanna_edit = $(`#li-${num1}-${num2}-${num3} p`).text();
        console.log(wanna_edit);
        li.empty();
        li.append($("<input/>", { type: "text", value: wanna_edit }));
        li.append($("<button >수정완료!</button>"));
        $(`#li-${num1}-${num2}-${num3} > button`).click(function () {
          save(num1, num2, num3);
        });
      }
      // 수정완료! 버튼 클릭시 이벤트리스너
      function save(num1, num2, num3) {
        let edit_done = $(
          `#li-${num1}-${num2}-${num3} > input[type=text]`
        ).val();
        console.log(num1, edit_done);
        $.ajax({
          type: "POST",
          url: "/test/edit",
          data: {
            edit_give: edit_done,
            num1_give: num1,
            num2_give: num2,
            num3_give: num3,
          },
          success: function (response) {
            alert(response["msg"]);
            window.location.reload();
          },
        });
      }
      function remove(num1, num2, num3) {
        $.ajax({
          type: "POST",
          url: "/test/remove",
          data: { num1_give: num1, num2_give: num2, num3_give: num3 },
          success: function (response) {
            alert(response["msg"]);
            window.location.reload();
          },
        });
      }
    </script>
    <script>
      function getWeather() {
        let city = document.getElementById("city").value;
        fetch("https://goweather.herokuapp.com/weather/" + city)
          .then((response) => response.json())
          .then((data) => {
            (document.getElementById("temp").innerHTML = data["temperature"]),
              (document.getElementById("desc").innerHTML = data["description"]);
          });
      }
    </script>
    <script
      src="https://kit.fontawesome.com/ec13307674.js"
      crossorigin="anonymous"
    ></script>
    <title>코딩하고십조</title>
    <link rel="stylesheet" href="../static/css/team.css" />
  </head>
  <body>
    <main>
      <header>
        <div class="team__header__icons">
          <img src="../static/img/i-love-coding-badge-400x400.png" />

        </div>
      </header>
      <div class="team__contents">
        <div class="team__contents-column">
          <div class="team__introduction">
            <h1>코딩하고십조</h1>
            <p>
              저희는 이번 프로젝트에서 전 세계 나라들을 검색해
              <span>날씨</span>를 확인할 수 있고 작성자의 이름과 글 한 줄로
              <span>방명록</span>을 남길 수 있으며
              <span>각 팀원들의 프로필</span>을 누르면 정확한 정보를 확인할 수
              있는 페이지를 만들었습니다
            </p>
            <p>
              팀 프로젝트를 하면서 역할을 나누긴 했었지만 첫
              <span>협업</span> 프로젝트이다 보니 모르는 부분을 거의 같이
              고민하고 해결하며 코드를 작성하였습니다
            </p>
            <p>
              저희 팀의 <span>궁극적인 목표</span>는 완벽한 결과물보단 팀원들과
              협업하는 방법을 깨우치고 개개인의 부족한 점을 정확히 깨달으며
              공부의 방향성을 확실하게 잡는 게 저희의 목표입니다
            </p>
          </div>
          <div class="team__members">
            <a href="/templates/gimin.html" class="team__members__avatar"></a>
            <a
              href="/templates/beomseok.html"
              class="team__members__avatar"
            ></a>
            <a
              href="/templates/seungjun.html"
              class="team__members__avatar"
            ></a>
            <a href="/templates/haksoo.html" class="team__members__avatar"></a>
          </div>
        </div>
        <div class="team__contents-column">
          <div class="team__weather">
            <h4>세계 도시 날씨</h4>
            <div class="team__weather__world">
              <div class="team__weather__world__search">
                <input id="city" type="text" value="" list="depList" />
                <datalist id="depList">
                  <option value="seoul"></option>
                  <option value="London"></option>
                  <option value="algiers"></option>
                  <option value="Luanda"></option>
                  <option value="NewDelhi"></option>
                  <option value="Manila"></option>
                  <option value="moscow"></option>
                  <option value="bangkok"></option>
                  <option value="ankara"></option>
                  <option value="hanoi"></option>
                  <option value="paris"></option>
                  <option value="berlin"></option>
                  <option value="rome"></option>
                  <option value="athens"></option>
                  <option value="amsterdam"></option>
                  <option value="oslo"></option>
                  <option value="lisbon"></option>
                  <option value="canberra"></option>
                  <option value="brasilia"></option>
                  <option value="paramaribo"></option>
                  <option value="montevideo"></option>
                  <option value="mexico city"></option>
                </datalist>
                <button onclick="getWeather()">
                  <i class="fa-solid fa-magnifying-glass"></i>
                </button>
              </div>
              <div class="team__weather__world__output">
                <h6 id="desc"></h6>
                <h6 id="temp"></h6>
              </div>
            </div>
          </div>
          <div class="team__promise">
            <h3>Promise</h3>
            <p>🤙 시간 약속 잘 지키기</p>
            <p>🤙 자리를 비울 시 미리 말해주기</p>
            <p>🤙 적극적으로 프로젝트에 참여하기</p>
            <p>🤙 상대방이 모르는 부분은 잘 알려주기</p>
            <p>🤙 문제가 있는 부분은 공유하기</p>
          </div>
        </div>
      </div>
      <div class="team__comments">
        <div class="mypost">
          <div class="form-floating mb-3">
            <input
              type="text"
              class="form-control"
              id="name"
              placeholder="url"
            />
            <label for="floatingInput">닉네임</label>
          </div>
          <div class="form-floating">
            <textarea
              class="form-control"
              placeholder="Leave a comment here"
              id="comment"
              style="height: 100px"
            ></textarea>
            <label for="floatingTextarea2">댓글 남기기</label>
          </div>
          <button onclick="save_comment()" type="button" class="btn btn-dark">
            댓글 남기기
          </button>
        </div>
        <div id="comment_list">

        </div>
      </div>
    </main>
  </body>
</html>